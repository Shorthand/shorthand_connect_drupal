<?php

/**
 * @file
 * Theme implementation to display a shorthand story node.
 */
?>

<div id="node-<?php print $node->nid; ?>" class="<?php print $classes; ?> clearfix"<?php print $attributes; ?>>

  <?php print render($title_prefix); ?>
  <?php if (!$page): ?>
    <h2<?php print $title_attributes; ?>>
      <a href="<?php print $node_url; ?>"><?php print $title; ?></a>
    </h2>
  <?php endif; ?>
  <?php print render($title_suffix); ?>

  <?php if ($display_submitted): ?>
    <div class="meta submitted">
      <?php print $user_picture; ?>
      <?php print $submitted; ?>
    </div>
  <?php endif; ?>

  <div class="content clearfix"<?php print $content_attributes; ?>>

      <?php if(!empty($story_id)): ?>
        <?php
        $story_body = preg_replace('/<link.*rel="amphtml"(.[^>]*>)\n/', '', $story_body);
        $story_body = preg_replace('/<meta property="og:[a-z]+" content=".*">\n/', '', $story_body);
        $story_body = preg_replace('/<meta name="twitter:[a-z]+" content=".*">\n/', '', $story_body);
        ?>
        
        <?php print $story_body; ?>
        <?php print $story_extra_html; ?>
      <?php endif; ?>

    </div>

  <?php
    // Remove the "Add new comment" link on the teaser page or if the comment
    // form is being displayed on the same page.
    if ($teaser || !empty($content['comments']['comment_form'])) {
      unset($content['links']['comment']['#links']['comment-add']);
    }
    // Only display the wrapper div if there are links.
    $links = render($content['links']);
    if ($links):
  ?>
    <div class="link-wrapper">
      <?php print $links; ?>
    </div>
    <?php endif; ?>

  <?php print render($content['comments']); ?>

</div>
